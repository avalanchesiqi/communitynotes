/Users/swu2/Development/communitynotes/.venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
INFO:birdwatch.runner:scorer python version: 3.9.6 (default, Mar 29 2024, 10:51:09) 
[Clang 15.0.0 (clang-1500.3.9.4)]
INFO:birdwatch.runner:scorer pandas version: 2.2.2
INFO:birdwatch.runner:beginning scorer execution
INFO:birdwatch.process_data:Timestamp of latest rating in data: 2021-01-23 01:54:44.227000
INFO:birdwatch.process_data:Timestamp of latest note in data: 2021-01-23 01:54:44.227000
INFO:birdwatch.process_data:Total raters: 18463
INFO:birdwatch.process_data:Identifying high volume raters
INFO:birdwatch.process_data:Total ratings: 368346
INFO:birdwatch.process_data:High volume threshold for 7 days: 35.0
INFO:birdwatch.process_data:High volume raters for 7 days: 12
INFO:birdwatch.process_data:High volume threshold for 28 days: 35.0
INFO:birdwatch.process_data:High volume raters for 28 days: 12
INFO:birdwatch.process_data:Total high volume raters: 12
INFO:birdwatch.process_data:Total ratings: 368346
INFO:birdwatch.process_data:Total ratings from high volume raters: 443

CONCAT WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 31: newNoteStatusHistory = oldNoteStatusHistory.merge(
  PandasTypeError: Type expectation mismatch on noteId: found=float64 expected=int64
  PandasTypeError: Type expectation mismatch on noteId: found=float64 expected=int64


MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 31: newNoteStatusHistory = oldNoteStatusHistory.merge(
  PandasTypeError: Output mismatch on createdAtMillis: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on createdAtMillis_notes: result=float64 expected=int64 (allowed)

INFO:birdwatch.note_status_history:total notes added to noteStatusHistory: 36925

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 57: newNoteStatusHistory[[c.noteIdKey, c.createdAtMillisKey]].merge(
  PandasTypeError: Input mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)
  PandasTypeError: Merge key mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)


MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/process_data.py, in _filter_misleading_notes, at line 287: ratings = ratings.merge(
  PandasTypeError: Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

INFO:birdwatch.process_data:Preprocess Data: Filter misleading notes, starting with 368346 ratings on 36921 notes
INFO:birdwatch.process_data:  Keeping 368346 ratings on 36921 misleading notes
INFO:birdwatch.process_data:  Keeping 0 ratings on 0 deleted notes that were previously scored (in note status history)
INFO:birdwatch.process_data:  Removing 0 ratings on 0 older notes that aren't deleted, but are not-misleading.
INFO:birdwatch.process_data:  Removing 0 ratings on 0 notes that were deleted and not in note status history (e.g. old).
INFO:birdwatch.process_data:Num Ratings: 368346, Num Unique Notes Rated: 36921, Num Unique Raters: 18463
INFO:birdwatch.process_data:Called filter_input_data_for_testing.
        Notes: 36925, Ratings: 368346. Max note createdAt: 2021-01-23 01:54:44.227000; Max rating createAt: 2021-01-23 01:54:44.227000
INFO:birdwatch.process_data:After filtering notes and ratings after particular timestamp (=None). 
        Notes: 36925, Ratings: 368346. Max note createdAt: 2021-01-23 01:54:44.227000; Max rating createAt: 2021-01-23 01:54:44.227000
INFO:birdwatch.process_data:After filtering ratings after first status (plus None hours) for notes created in last 14 days. 
        Notes: 36925, Ratings: 368346. Max note createdAt: 2021-01-23 01:54:44.227000; Max rating createAt: 2021-01-23 01:54:44.227000
INFO:birdwatch.process_data:After filtering prescoring notes and ratings to simulate a delay of None hours: 
        Notes: 36925, Ratings: 368346. Max note createdAt: 2021-01-23 01:54:44.227000; Max rating createAt: 2021-01-23 01:54:44.227000
INFO:birdwatch.constants:Compute pair counts dict elapsed time: 6.61 secs (0.11 mins)
INFO:birdwatch.constants:Compute PMI and minSim elapsed time: 2.01 secs (0.03 mins)
INFO:birdwatch.constants:Delete unneeded pairs from pairCountsDict elapsed time: 0.10 secs (0.00 mins)
INFO:birdwatch.constants:Aggregate into cliques by post selection similarity elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Compute Post Selection Similarity elapsed time: 9.23 secs (0.15 mins)
INFO:birdwatch.run_scoring:logging environment variables
INFO:birdwatch.run_scoring:notes total RAM: 2917075 bytes (0.003 GB)
                                    column     dtype     RAM
0                                   noteId     int64  295400
1                  noteAuthorParticipantId    object  295400
2                          createdAtMillis     int64  295400
3                                  tweetId    object  295400
4                           classification    object  295400
5                               believable  category   36925
6                                  harmful  category   36925
7                     validationDifficulty  category   36925
8                          misleadingOther      Int8   73850
9                   misleadingFactualError      Int8   73850
10              misleadingManipulatedMedia      Int8   73850
11           misleadingOutdatedInformation      Int8   73850
12       misleadingMissingImportantContext      Int8   73850
13         misleadingUnverifiedClaimAsFact      Int8   73850
14                        misleadingSatire      Int8   73850
15                      notMisleadingOther      Int8   73850
16           notMisleadingFactuallyCorrect      Int8   73850
17  notMisleadingOutdatedButNotWhenWritten      Int8   73850
18              notMisleadingClearlySatire      Int8   73850
19            notMisleadingPersonalOpinion      Int8   73850
20                      trustworthySources      Int8   73850
21                                 summary    object  295400
22                             isMediaNote      Int8   73850
INFO:birdwatch.run_scoring:ratings total RAM: 35361348 bytes (0.035 GB)
                                  column     dtype      RAM
0                                 noteId     int64  2946768
1                     raterParticipantId    object  2946768
2                        createdAtMillis     int64  2946768
3                                version      Int8   736692
4                                  agree      Int8   736692
5                               disagree      Int8   736692
6                                helpful      Int8   736692
7                             notHelpful      Int8   736692
8                       helpfulnessLevel  category   368478
9                           helpfulOther      Int8   736692
10                    helpfulInformative      Int8   736692
11                          helpfulClear      Int8   736692
12                     helpfulEmpathetic      Int8   736692
13                    helpfulGoodSources      Int8   736692
14                  helpfulUniqueContext      Int8   736692
15                 helpfulAddressesClaim      Int8   736692
16               helpfulImportantContext      Int8   736692
17               helpfulUnbiasedLanguage      Int8   736692
18                       notHelpfulOther      Int8   736692
19                   notHelpfulIncorrect      Int8   736692
20  notHelpfulSourcesMissingOrUnreliable      Int8   736692
21    notHelpfulOpinionSpeculationOrBias      Int8   736692
22            notHelpfulMissingKeyPoints      Int8   736692
23                    notHelpfulOutdated      Int8   736692
24            notHelpfulHardToUnderstand      Int8   736692
25       notHelpfulArgumentativeOrBiased      Int8   736692
26                    notHelpfulOffTopic      Int8   736692
27       notHelpfulSpamHarassmentOrAbuse      Int8   736692
28           notHelpfulIrrelevantSources      Int8   736692
29          notHelpfulOpinionSpeculation      Int8   736692
30               notHelpfulNoteNotNeeded      Int8   736692
31                        ratedOnTweetId     int64  2946768
32                            helpfulNum   float64  2946768
33                       highVolumeRater      bool   368346
INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 4763502 bytes (0.005 GB)
                                            column     dtype     RAM
0                                           noteId     int64  295408
1                          noteAuthorParticipantId    object  295408
2                                  createdAtMillis   float64  295408
3               timestampMillisOfFirstNonNMRStatus   float64  295408
4                                firstNonNMRStatus  category   36926
5                   timestampMillisOfCurrentStatus   float64  295408
6                                    currentStatus  category   36934
7              timestampMillisOfLatestNonNMRStatus   float64  295408
8                           mostRecentNonNMRStatus  category   36926
9                      timestampMillisOfStatusLock   float64  295408
10                                    lockedStatus  category   36934
11                      timestampMillisOfRetroLock   float64  295408
12                               currentCoreStatus  category   36934
13                          currentExpansionStatus  category   36934
14                              currentGroupStatus  category   36934
15                                currentDecidedBy  category   36934
16                            currentModelingGroup   float64  295408
17         timestampMillisOfMostRecentStatusChange   float64  295408
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  295408
19                         currentMultiGroupStatus  category   36926
20                       currentModelingMultiGroup   float64  295408
21             timestampMinuteOfFinalScoringOutput   float64  295408
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  295408
23                                  classification    object  295408
INFO:birdwatch.run_scoring:userEnrollment total RAM: 1052399 bytes (0.001 GB)
                           column     dtype     RAM
0                   participantId    object  147704
1                 enrollmentState    object  147704
2  successfulRatingNeededToEarnIn     int64  147704
3      timestampOfLastStateChange     int64  147704
4          timestampOfLastEarnOut   float64  147704
5              modelingPopulation  category   18471
6                   modelingGroup   float64  147704
7          numberOfTimesEarnedOut     int64  147704
INFO:birdwatch.constants:Logging Prescoring Inputs Initial RAM usage elapsed time: 0.02 secs (0.00 mins)
INFO:birdwatch.constants:Set Note Topics to Dummy dataframe by copying all noteIds elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.run_scoring:ratings summary before PSS: deec976c28c783335a2654a5c6f3337b560e3492404165e6de53641e6000744b
INFO:birdwatch.run_scoring:Post Selection Similarity Prescoring: begin with 368346 ratings.
INFO:birdwatch.run_scoring:Post Selection Similarity Prescoring: 368346 ratings remaining.
INFO:birdwatch.constants:Filter ratings by Post Selection Similarity elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.run_scoring:ratings summary after PSS: deec976c28c783335a2654a5c6f3337b560e3492404165e6de53641e6000744b
INFO:birdwatch.run_scoring:Error converting user IDs to ints.  IDs will remain as strings. ValueError("invalid literal for int() with base 10: 'xxx'")
INFO:birdwatch.run_scoring:notes total RAM: 2917075 bytes (0.003 GB)
                                    column     dtype     RAM
0                                   noteId     int64  295400
1                  noteAuthorParticipantId    object  295400
2                          createdAtMillis     int64  295400
3                                  tweetId    object  295400
4                           classification    object  295400
5                               believable  category   36925
6                                  harmful  category   36925
7                     validationDifficulty  category   36925
8                          misleadingOther      Int8   73850
9                   misleadingFactualError      Int8   73850
10              misleadingManipulatedMedia      Int8   73850
11           misleadingOutdatedInformation      Int8   73850
12       misleadingMissingImportantContext      Int8   73850
13         misleadingUnverifiedClaimAsFact      Int8   73850
14                        misleadingSatire      Int8   73850
15                      notMisleadingOther      Int8   73850
16           notMisleadingFactuallyCorrect      Int8   73850
17  notMisleadingOutdatedButNotWhenWritten      Int8   73850
18              notMisleadingClearlySatire      Int8   73850
19            notMisleadingPersonalOpinion      Int8   73850
20                      trustworthySources      Int8   73850
21                                 summary    object  295400
22                             isMediaNote      Int8   73850
INFO:birdwatch.run_scoring:ratings total RAM: 35361348 bytes (0.035 GB)
                                  column     dtype      RAM
0                                 noteId     int64  2946768
1                     raterParticipantId    object  2946768
2                        createdAtMillis     int64  2946768
3                                version      Int8   736692
4                                  agree      Int8   736692
5                               disagree      Int8   736692
6                                helpful      Int8   736692
7                             notHelpful      Int8   736692
8                       helpfulnessLevel  category   368478
9                           helpfulOther      Int8   736692
10                    helpfulInformative      Int8   736692
11                          helpfulClear      Int8   736692
12                     helpfulEmpathetic      Int8   736692
13                    helpfulGoodSources      Int8   736692
14                  helpfulUniqueContext      Int8   736692
15                 helpfulAddressesClaim      Int8   736692
16               helpfulImportantContext      Int8   736692
17               helpfulUnbiasedLanguage      Int8   736692
18                       notHelpfulOther      Int8   736692
19                   notHelpfulIncorrect      Int8   736692
20  notHelpfulSourcesMissingOrUnreliable      Int8   736692
21    notHelpfulOpinionSpeculationOrBias      Int8   736692
22            notHelpfulMissingKeyPoints      Int8   736692
23                    notHelpfulOutdated      Int8   736692
24            notHelpfulHardToUnderstand      Int8   736692
25       notHelpfulArgumentativeOrBiased      Int8   736692
26                    notHelpfulOffTopic      Int8   736692
27       notHelpfulSpamHarassmentOrAbuse      Int8   736692
28           notHelpfulIrrelevantSources      Int8   736692
29          notHelpfulOpinionSpeculation      Int8   736692
30               notHelpfulNoteNotNeeded      Int8   736692
31                        ratedOnTweetId     int64  2946768
32                            helpfulNum   float64  2946768
33                       highVolumeRater      bool   368346
INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 4763502 bytes (0.005 GB)
                                            column     dtype     RAM
0                                           noteId     int64  295408
1                          noteAuthorParticipantId    object  295408
2                                  createdAtMillis   float64  295408
3               timestampMillisOfFirstNonNMRStatus   float64  295408
4                                firstNonNMRStatus  category   36926
5                   timestampMillisOfCurrentStatus   float64  295408
6                                    currentStatus  category   36934
7              timestampMillisOfLatestNonNMRStatus   float64  295408
8                           mostRecentNonNMRStatus  category   36926
9                      timestampMillisOfStatusLock   float64  295408
10                                    lockedStatus  category   36934
11                      timestampMillisOfRetroLock   float64  295408
12                               currentCoreStatus  category   36934
13                          currentExpansionStatus  category   36934
14                              currentGroupStatus  category   36934
15                                currentDecidedBy  category   36934
16                            currentModelingGroup   float64  295408
17         timestampMillisOfMostRecentStatusChange   float64  295408
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  295408
19                         currentMultiGroupStatus  category   36926
20                       currentModelingMultiGroup   float64  295408
21             timestampMinuteOfFinalScoringOutput   float64  295408
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  295408
23                                  classification    object  295408
INFO:birdwatch.run_scoring:userEnrollment total RAM: 1052399 bytes (0.001 GB)
                           column     dtype     RAM
0                   participantId    object  147704
1                 enrollmentState    object  147704
2  successfulRatingNeededToEarnIn     int64  147704
3      timestampOfLastStateChange     int64  147704
4          timestampOfLastEarnOut   float64  147704
5              modelingPopulation  category   18471
6                   modelingGroup   float64  147704
7          numberOfTimesEarnedOut     int64  147704
INFO:birdwatch.constants:Logging Prescoring Inputs RAM usage before _run_scorers elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.scorer:prescore: Torch intra-op parallelism for MFCoreScorer set to: 12
INFO:birdwatch.scorer:Filtering ratings for MFCoreScorer.  Original rating length: 368346
INFO:birdwatch.scorer:  Ratings without assigned group: 0
INFO:birdwatch.scorer:  Ratings after group filter: 368346
INFO:birdwatch.scorer:MFCoreScorer Filter input elapsed time: 0.09 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:ratings summary MFCoreScorer: deec976c28c783335a2654a5c6f3337b560e3492404165e6de53641e6000744b
INFO:birdwatch.process_data:After applying min 10 ratings per rater and min 5 raters per note: 
Num Ratings: 363695, Num Unique Notes Rated: 35861, Num Unique Raters: 18355
INFO:birdwatch.scorer:MFCoreScorer Prepare ratings elapsed time: 0.09 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:ratingsForTraining summary MFCoreScorer: 6fa6dbccaf399d6aead4989832345e8cbfb09c393f38fc2e82ec59c3fe690d99
INFO:birdwatch.mf_base_scorer:noteStatusHistory summary MFCoreScorer: 2481f2d94f063e9d75dadbe1df7074febc8200ef0ed3931b2c6608ea09e17967
INFO:birdwatch.mf_base_scorer:userEnrollmentRaw summary MFCoreScorer: 495d10cb7472de0bbae8d4dc45142420262cc97266d08f9db2c733833094770b
INFO:birdwatch.scorer:MFCoreScorer Prepare data for stable initialization elapsed time: 0.12 secs (0.00 mins)
INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
INFO:birdwatch.wandb_utils:Reinitializing W&B run
INFO:birdwatch.wandb_utils:W&B is disabled
DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/Users/swu2/Development/communitynotes, stdin=None, shell=False, universal_newlines=False)
DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/Users/swu2/Development/communitynotes, stdin=None, shell=False, universal_newlines=False)
DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/Users/swu2/Development/communitynotes, stdin=None, shell=False, universal_newlines=False)
DEBUG:wandb:no default config file found in config-defaults.yaml
INFO:birdwatch.matrix_factorization:------------------
INFO:birdwatch.matrix_factorization:Users: 18355, Notes: 35861
INFO:birdwatch.matrix_factorization:learning rate set to :1.0
INFO:birdwatch.matrix_factorization:cpu
INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 10.141797495886896
INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 19.814491964042496
INFO:birdwatch.matrix_factorization:epoch 0 6.657871723175049
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 6.168342113494873
INFO:birdwatch.matrix_factorization:epoch 20 0.244246244430542
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.1733669936656952
INFO:birdwatch.matrix_factorization:epoch 40 0.10135343670845032
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.06516662240028381
INFO:birdwatch.matrix_factorization:epoch 60 0.07782943546772003
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.04166564345359802
INFO:birdwatch.matrix_factorization:epoch 80 0.07390930503606796
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0379139706492424
INFO:birdwatch.matrix_factorization:epoch 100 0.07306669652462006
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03725215420126915
INFO:birdwatch.matrix_factorization:epoch 120 0.0727243423461914
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03704371303319931
INFO:birdwatch.matrix_factorization:epoch 140 0.07236184179782867
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03693792596459389
INFO:birdwatch.matrix_factorization:epoch 160 0.0717528760433197
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03675598278641701
INFO:birdwatch.matrix_factorization:epoch 180 0.07081460952758789
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03631133213639259
INFO:birdwatch.matrix_factorization:epoch 200 0.06959294527769089
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.034867338836193085
INFO:birdwatch.matrix_factorization:epoch 220 0.06774957478046417
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0315505675971508
INFO:birdwatch.matrix_factorization:epoch 240 0.0666033923625946
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029552016407251358
INFO:birdwatch.matrix_factorization:epoch 260 0.06636951118707657
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029187364503741264
INFO:birdwatch.matrix_factorization:epoch 280 0.06634817272424698
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029163718223571777
INFO:birdwatch.matrix_factorization:Num epochs: 285
INFO:birdwatch.matrix_factorization:epoch 285 0.06634769588708878
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02916436456143856
INFO:birdwatch.matrix_factorization:Global Intercept: 0.18997183442115784
INFO:birdwatch.wandb_utils:Finishing W&B run
INFO:birdwatch.scorer:MFCoreScorer MF on stable-initialization subset elapsed time: 5.26 secs (0.09 mins)
INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
INFO:birdwatch.wandb_utils:Reinitializing W&B run
INFO:birdwatch.wandb_utils:W&B is disabled
DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/Users/swu2/Development/communitynotes, stdin=None, shell=False, universal_newlines=False)
DEBUG:wandb:no default config file found in config-defaults.yaml
INFO:birdwatch.matrix_factorization:------------------
INFO:birdwatch.matrix_factorization:Users: 18355, Notes: 35861
INFO:birdwatch.matrix_factorization:initializing notes
/Users/swu2/Development/communitynotes/sourcecode/scoring/matrix_factorization/matrix_factorization.py:193: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  noteInit[c.internalNoteInterceptKey].fillna(0.0, inplace=True)
/Users/swu2/Development/communitynotes/sourcecode/scoring/matrix_factorization/matrix_factorization.py:199: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  noteInit[c.note_factor_key(i)].fillna(0.0, inplace=True)
INFO:birdwatch.matrix_factorization:initializing users
INFO:birdwatch.matrix_factorization:initialized global intercept
INFO:birdwatch.matrix_factorization:learning rate set to :0.2
INFO:birdwatch.matrix_factorization:cpu
INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 10.141797495886896
INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 19.814491964042496
INFO:birdwatch.matrix_factorization:epoch 0 0.13007456064224243
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.09494618326425552
INFO:birdwatch.matrix_factorization:epoch 20 0.07414533942937851
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.03965888172388077
INFO:birdwatch.matrix_factorization:epoch 40 0.06681863218545914
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029188187792897224
INFO:birdwatch.matrix_factorization:epoch 60 0.06641262769699097
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02903580851852894
INFO:birdwatch.matrix_factorization:epoch 80 0.06636367738246918
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02935333177447319
INFO:birdwatch.matrix_factorization:Num epochs: 92
INFO:birdwatch.matrix_factorization:epoch 92 0.0663498118519783
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02922610007226467
INFO:birdwatch.matrix_factorization:Global Intercept: 0.19005705416202545
INFO:birdwatch.wandb_utils:Finishing W&B run
INFO:birdwatch.scorer:MFCoreScorer First full MF (initializated with stable-initialization) elapsed time: 1.33 secs (0.02 mins)
INFO:birdwatch.scorer:MFCoreScorer First MF/stable init elapsed time: 6.72 secs (0.11 mins)
INFO:birdwatch.mf_base_scorer:Skipping rep-filtering in prescoring for MFCoreScorer
/Users/swu2/Development/communitynotes/sourcecode/scoring/mf_base_scorer.py:595: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  helpfulnessScores[
/Users/swu2/Development/communitynotes/sourcecode/scoring/mf_base_scorer.py:615: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  harassmentAbuseNoteParams[[c.harassmentNoteInterceptKey, c.harassmentNoteFactor1Key]] = np.nan
/Users/swu2/Development/communitynotes/sourcecode/scoring/mf_base_scorer.py:615: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  harassmentAbuseNoteParams[[c.harassmentNoteInterceptKey, c.harassmentNoteFactor1Key]] = np.nan
INFO:birdwatch.mf_base_scorer:In MFCoreScorer prescoring, about to call diligence with 363695 final round ratings.
INFO:birdwatch.reputation_matrix_factorization:Setup model: noteInitState: 
None,
 raterInitState: 
                                      raterParticipantId  internalRaterFactor1
0      0000000000000000000000000000000000000000000000...              0.263893
1      0000000000000000000000000000000000000000000000...             -0.335347
2      0000000000000000000000000000000000000000000000...             -0.200977
3      0000000000000000000000000000000000000000000000...              0.139743
4      0000000000000000000000000000000000000000000000...             -0.191818
...                                                  ...                   ...
18350  0000000000000000000000000000000000000000000000...              0.552524
18351  0000000000000000000000000000000000000000000000...              0.067809
18352  0000000000000000000000000000000000000000000000...              0.118956
18353  0000000000000000000000000000000000000000000000...              0.037718
18354  0000000000000000000000000000000000000000000000...             -0.356194

[18355 rows x 2 columns]
INFO:birdwatch.reputation_matrix_factorization:Initializing internalRaterFactor1:
INFO:birdwatch.reputation_matrix_factorization:  num in dataset: 18355, vs. num we are initializing: 18355
INFO:birdwatch.reputation_matrix_factorization:  uninitialized internalRaterFactor1s: 0
INFO:birdwatch.reputation_matrix_factorization:  initialized internalRaterFactor1s: 18355
INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterIntercept
INFO:birdwatch.reputation_matrix_factorization:Not initializing internalRaterReputation
INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteFactor1
INFO:birdwatch.reputation_matrix_factorization:Not initializing internalNoteIntercept
INFO:birdwatch.reputation_matrix_factorization:Reputation Matrix Factorization: rater reputation frozen
INFO:birdwatch.reputation_matrix_factorization:Round 1:
INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=2.788850 | time=0.0s
INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=1.552423 | time=0.4s
INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=1.513912 | time=0.9s
INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=1.507002 | time=1.4s
INFO:birdwatch.reputation_matrix_factorization:epoch=120 | loss=1.504459 | time=1.8s
INFO:birdwatch.reputation_matrix_factorization:epoch=150 | loss=1.503163 | time=2.3s
INFO:birdwatch.reputation_matrix_factorization:epoch=180 | loss=1.502392 | time=2.7s
INFO:birdwatch.reputation_matrix_factorization:epoch=210 | loss=1.501890 | time=3.2s
INFO:birdwatch.reputation_matrix_factorization:epoch=240 | loss=1.501540 | time=3.7s
INFO:birdwatch.reputation_matrix_factorization:epoch=270 | loss=1.501286 | time=4.1s
INFO:birdwatch.reputation_matrix_factorization:epoch=300 | loss=1.501094 | time=4.6s
INFO:birdwatch.reputation_matrix_factorization:After round 1, global bias: Parameter containing:
tensor(-6.8118, requires_grad=True)
INFO:birdwatch.reputation_matrix_factorization:
Round 2: learn rater rep (and everything else), freeze note intercept
INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=1.501088 | time=0.0s
INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.002750 | time=0.4s
INFO:birdwatch.reputation_matrix_factorization:epoch=060 | loss=0.001825 | time=0.9s
INFO:birdwatch.reputation_matrix_factorization:epoch=090 | loss=0.000103 | time=1.3s
INFO:birdwatch.reputation_matrix_factorization:epoch=110 | loss=0.000029 | time=1.6s
INFO:birdwatch.reputation_matrix_factorization:
Round 3: fit intercepts and global intercept with everything else frozen
INFO:birdwatch.reputation_matrix_factorization:epoch=000 | loss=0.000022 | time=0.0s
INFO:birdwatch.reputation_matrix_factorization:epoch=030 | loss=0.000093 | time=0.3s
INFO:birdwatch.reputation_matrix_factorization:epoch=050 | loss=0.000020 | time=0.5s
INFO:birdwatch.reputation_matrix_factorization:After round 3, global bias: Parameter containing:
tensor(-15.9550, requires_grad=True)
INFO:birdwatch.diligence_model:Low diligence training loss: 1.5011, 0.0000, 0.0000
INFO:birdwatch.scorer:MFCoreScorer Low Diligence MF elapsed time: 6.90 secs (0.12 mins)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_note_stats, at line 348: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on numRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on numRatingsLast28: result=float64 expected=int64 (allowed)

INFO:birdwatch.note_ratings:dropped 0 out of 367430 ratings due to NaN factor.

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 595: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on minSignCount: result=float64 expected=int32 (allowed)
  PandasTypeError: Output mismatch on netMinHelpful: result=float64 expected=int32 (allowed)

INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 0.30 secs (0.00 mins)
INFO:birdwatch.constants:MFCoreScorer: Compute tag thresholds for percentiles elapsed time: 0.25 secs (0.00 mins)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/mf_base_scorer.py, in _prescore_notes_and_users, at line 973: raterModelOutput = raterParams.merge(
  PandasTypeError: Output mismatch on totalRatingsMadeByRater: result=float64 expected=int64 (allowed)

INFO:birdwatch.run_scoring:----
    Completed individual scorers. Ran in parallel: False.  Succeeded in 16.19 seconds. 
    Individual scorers: (name, runtime): [('MFCoreScorer', '0.27 mins')]
    ----
INFO:birdwatch.run_scoring:notes total RAM: 2917075 bytes (0.003 GB)
                                    column     dtype     RAM
0                                   noteId     int64  295400
1                  noteAuthorParticipantId    object  295400
2                          createdAtMillis     int64  295400
3                                  tweetId    object  295400
4                           classification    object  295400
5                               believable  category   36925
6                                  harmful  category   36925
7                     validationDifficulty  category   36925
8                          misleadingOther      Int8   73850
9                   misleadingFactualError      Int8   73850
10              misleadingManipulatedMedia      Int8   73850
11           misleadingOutdatedInformation      Int8   73850
12       misleadingMissingImportantContext      Int8   73850
13         misleadingUnverifiedClaimAsFact      Int8   73850
14                        misleadingSatire      Int8   73850
15                      notMisleadingOther      Int8   73850
16           notMisleadingFactuallyCorrect      Int8   73850
17  notMisleadingOutdatedButNotWhenWritten      Int8   73850
18              notMisleadingClearlySatire      Int8   73850
19            notMisleadingPersonalOpinion      Int8   73850
20                      trustworthySources      Int8   73850
21                                 summary    object  295400
22                             isMediaNote      Int8   73850
INFO:birdwatch.run_scoring:ratings total RAM: 35361348 bytes (0.035 GB)
                                  column     dtype      RAM
0                                 noteId     int64  2946768
1                     raterParticipantId    object  2946768
2                        createdAtMillis     int64  2946768
3                                version      Int8   736692
4                                  agree      Int8   736692
5                               disagree      Int8   736692
6                                helpful      Int8   736692
7                             notHelpful      Int8   736692
8                       helpfulnessLevel  category   368478
9                           helpfulOther      Int8   736692
10                    helpfulInformative      Int8   736692
11                          helpfulClear      Int8   736692
12                     helpfulEmpathetic      Int8   736692
13                    helpfulGoodSources      Int8   736692
14                  helpfulUniqueContext      Int8   736692
15                 helpfulAddressesClaim      Int8   736692
16               helpfulImportantContext      Int8   736692
17               helpfulUnbiasedLanguage      Int8   736692
18                       notHelpfulOther      Int8   736692
19                   notHelpfulIncorrect      Int8   736692
20  notHelpfulSourcesMissingOrUnreliable      Int8   736692
21    notHelpfulOpinionSpeculationOrBias      Int8   736692
22            notHelpfulMissingKeyPoints      Int8   736692
23                    notHelpfulOutdated      Int8   736692
24            notHelpfulHardToUnderstand      Int8   736692
25       notHelpfulArgumentativeOrBiased      Int8   736692
26                    notHelpfulOffTopic      Int8   736692
27       notHelpfulSpamHarassmentOrAbuse      Int8   736692
28           notHelpfulIrrelevantSources      Int8   736692
29          notHelpfulOpinionSpeculation      Int8   736692
30               notHelpfulNoteNotNeeded      Int8   736692
31                        ratedOnTweetId     int64  2946768
32                            helpfulNum   float64  2946768
33                       highVolumeRater      bool   368346
INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 4763502 bytes (0.005 GB)
                                            column     dtype     RAM
0                                           noteId     int64  295408
1                          noteAuthorParticipantId    object  295408
2                                  createdAtMillis   float64  295408
3               timestampMillisOfFirstNonNMRStatus   float64  295408
4                                firstNonNMRStatus  category   36926
5                   timestampMillisOfCurrentStatus   float64  295408
6                                    currentStatus  category   36934
7              timestampMillisOfLatestNonNMRStatus   float64  295408
8                           mostRecentNonNMRStatus  category   36926
9                      timestampMillisOfStatusLock   float64  295408
10                                    lockedStatus  category   36934
11                      timestampMillisOfRetroLock   float64  295408
12                               currentCoreStatus  category   36934
13                          currentExpansionStatus  category   36934
14                              currentGroupStatus  category   36934
15                                currentDecidedBy  category   36934
16                            currentModelingGroup   float64  295408
17         timestampMillisOfMostRecentStatusChange   float64  295408
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  295408
19                         currentMultiGroupStatus  category   36926
20                       currentModelingMultiGroup   float64  295408
21             timestampMinuteOfFinalScoringOutput   float64  295408
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  295408
23                                  classification    object  295408
INFO:birdwatch.run_scoring:userEnrollment total RAM: 1052399 bytes (0.001 GB)
                           column     dtype     RAM
0                   participantId    object  147704
1                 enrollmentState    object  147704
2  successfulRatingNeededToEarnIn     int64  147704
3      timestampOfLastStateChange     int64  147704
4          timestampOfLastEarnOut   float64  147704
5              modelingPopulation  category   18471
6                   modelingGroup   float64  147704
7          numberOfTimesEarnedOut     int64  147704
INFO:birdwatch.run_scoring:prescoringNoteModelOutput total RAM: 1864772 bytes (0.002 GB)
                            column    dtype     RAM
0                           noteId    int64  286888
1            internalNoteIntercept  float32  143444
2              internalNoteFactor1  float32  143444
3                       scorerName   object  286888
4        lowDiligenceNoteIntercept  float32  143444
5          lowDiligenceNoteFactor1  float32  143444
6  lowDiligenceNoteInterceptRound2  float32  143444
7          harassmentNoteIntercept  float64  286888
8            harassmentNoteFactor1  float64  286888
INFO:birdwatch.run_scoring:prescoringRaterModelOutput total RAM: 2679830 bytes (0.003 GB)
                                          column    dtype     RAM
0                             raterParticipantId   object  146840
1                         internalRaterIntercept  float32   73420
2                           internalRaterFactor1  float32   73420
3                         crhCrnhRatioDifference  float64  146840
4                                  meanNoteScore  float64  146840
5                                raterAgreeRatio  float64  146840
6                      aboveHelpfulnessThreshold  float64  146840
7                                     scorerName   object  146840
8                        internalRaterReputation  float64  146840
9                     lowDiligenceRaterIntercept  float32   73420
10                      lowDiligenceRaterFactor1  float32   73420
11                   lowDiligenceRaterReputation  float32   73420
12              lowDiligenceRaterInterceptRound2  float32   73420
13                incorrectTagRatingsMadeByRater     Int8   36710
14                       totalRatingsMadeByRater  float64  146840
15                            postSelectionValue  float64  146840
16                  successfulRatingHelpfulCount  float64  146840
17               successfulRatingNotHelpfulCount  float64  146840
18                unsuccessfulRatingHelpfulCount  float64  146840
19             unsuccessfulRatingNotHelpfulCount  float64  146840
20                 totalHelpfulHarassmentPenalty  float64  146840
21  raterAgreeRatioKeyWithHarassmentAbusePenalty  float64  146840
INFO:birdwatch.constants:Logging Prescoring Results RAM usage (before conversion) elapsed time: 0.02 secs (0.00 mins)
INFO:birdwatch.run_scoring:notes total RAM: 2917075 bytes (0.003 GB)
                                    column     dtype     RAM
0                                   noteId     int64  295400
1                  noteAuthorParticipantId    object  295400
2                          createdAtMillis     int64  295400
3                                  tweetId    object  295400
4                           classification    object  295400
5                               believable  category   36925
6                                  harmful  category   36925
7                     validationDifficulty  category   36925
8                          misleadingOther      Int8   73850
9                   misleadingFactualError      Int8   73850
10              misleadingManipulatedMedia      Int8   73850
11           misleadingOutdatedInformation      Int8   73850
12       misleadingMissingImportantContext      Int8   73850
13         misleadingUnverifiedClaimAsFact      Int8   73850
14                        misleadingSatire      Int8   73850
15                      notMisleadingOther      Int8   73850
16           notMisleadingFactuallyCorrect      Int8   73850
17  notMisleadingOutdatedButNotWhenWritten      Int8   73850
18              notMisleadingClearlySatire      Int8   73850
19            notMisleadingPersonalOpinion      Int8   73850
20                      trustworthySources      Int8   73850
21                                 summary    object  295400
22                             isMediaNote      Int8   73850
INFO:birdwatch.run_scoring:ratings total RAM: 35361348 bytes (0.035 GB)
                                  column     dtype      RAM
0                                 noteId     int64  2946768
1                     raterParticipantId    object  2946768
2                        createdAtMillis     int64  2946768
3                                version      Int8   736692
4                                  agree      Int8   736692
5                               disagree      Int8   736692
6                                helpful      Int8   736692
7                             notHelpful      Int8   736692
8                       helpfulnessLevel  category   368478
9                           helpfulOther      Int8   736692
10                    helpfulInformative      Int8   736692
11                          helpfulClear      Int8   736692
12                     helpfulEmpathetic      Int8   736692
13                    helpfulGoodSources      Int8   736692
14                  helpfulUniqueContext      Int8   736692
15                 helpfulAddressesClaim      Int8   736692
16               helpfulImportantContext      Int8   736692
17               helpfulUnbiasedLanguage      Int8   736692
18                       notHelpfulOther      Int8   736692
19                   notHelpfulIncorrect      Int8   736692
20  notHelpfulSourcesMissingOrUnreliable      Int8   736692
21    notHelpfulOpinionSpeculationOrBias      Int8   736692
22            notHelpfulMissingKeyPoints      Int8   736692
23                    notHelpfulOutdated      Int8   736692
24            notHelpfulHardToUnderstand      Int8   736692
25       notHelpfulArgumentativeOrBiased      Int8   736692
26                    notHelpfulOffTopic      Int8   736692
27       notHelpfulSpamHarassmentOrAbuse      Int8   736692
28           notHelpfulIrrelevantSources      Int8   736692
29          notHelpfulOpinionSpeculation      Int8   736692
30               notHelpfulNoteNotNeeded      Int8   736692
31                        ratedOnTweetId     int64  2946768
32                            helpfulNum   float64  2946768
33                       highVolumeRater      bool   368346
INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 4763502 bytes (0.005 GB)
                                            column     dtype     RAM
0                                           noteId     int64  295408
1                          noteAuthorParticipantId    object  295408
2                                  createdAtMillis   float64  295408
3               timestampMillisOfFirstNonNMRStatus   float64  295408
4                                firstNonNMRStatus  category   36926
5                   timestampMillisOfCurrentStatus   float64  295408
6                                    currentStatus  category   36934
7              timestampMillisOfLatestNonNMRStatus   float64  295408
8                           mostRecentNonNMRStatus  category   36926
9                      timestampMillisOfStatusLock   float64  295408
10                                    lockedStatus  category   36934
11                      timestampMillisOfRetroLock   float64  295408
12                               currentCoreStatus  category   36934
13                          currentExpansionStatus  category   36934
14                              currentGroupStatus  category   36934
15                                currentDecidedBy  category   36934
16                            currentModelingGroup   float64  295408
17         timestampMillisOfMostRecentStatusChange   float64  295408
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  295408
19                         currentMultiGroupStatus  category   36926
20                       currentModelingMultiGroup   float64  295408
21             timestampMinuteOfFinalScoringOutput   float64  295408
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  295408
23                                  classification    object  295408
INFO:birdwatch.run_scoring:userEnrollment total RAM: 1052399 bytes (0.001 GB)
                           column     dtype     RAM
0                   participantId    object  147704
1                 enrollmentState    object  147704
2  successfulRatingNeededToEarnIn     int64  147704
3      timestampOfLastStateChange     int64  147704
4          timestampOfLastEarnOut   float64  147704
5              modelingPopulation  category   18471
6                   modelingGroup   float64  147704
7          numberOfTimesEarnedOut     int64  147704
INFO:birdwatch.run_scoring:prescoringNoteModelOutput total RAM: 1864772 bytes (0.002 GB)
                            column    dtype     RAM
0                           noteId    int64  286888
1            internalNoteIntercept  float32  143444
2              internalNoteFactor1  float32  143444
3                       scorerName   object  286888
4        lowDiligenceNoteIntercept  float32  143444
5          lowDiligenceNoteFactor1  float32  143444
6  lowDiligenceNoteInterceptRound2  float32  143444
7          harassmentNoteIntercept  float64  286888
8            harassmentNoteFactor1  float64  286888
INFO:birdwatch.run_scoring:prescoringRaterModelOutput total RAM: 2679830 bytes (0.003 GB)
                                          column    dtype     RAM
0                             raterParticipantId   object  146840
1                         internalRaterIntercept  float32   73420
2                           internalRaterFactor1  float32   73420
3                         crhCrnhRatioDifference  float64  146840
4                                  meanNoteScore  float64  146840
5                                raterAgreeRatio  float64  146840
6                      aboveHelpfulnessThreshold  float64  146840
7                                     scorerName   object  146840
8                        internalRaterReputation  float64  146840
9                     lowDiligenceRaterIntercept  float32   73420
10                      lowDiligenceRaterFactor1  float32   73420
11                   lowDiligenceRaterReputation  float32   73420
12              lowDiligenceRaterInterceptRound2  float32   73420
13                incorrectTagRatingsMadeByRater     Int8   36710
14                       totalRatingsMadeByRater  float64  146840
15                            postSelectionValue  float64  146840
16                  successfulRatingHelpfulCount  float64  146840
17               successfulRatingNotHelpfulCount  float64  146840
18                unsuccessfulRatingHelpfulCount  float64  146840
19             unsuccessfulRatingNotHelpfulCount  float64  146840
20                 totalHelpfulHarassmentPenalty  float64  146840
21  raterAgreeRatioKeyWithHarassmentAbusePenalty  float64  146840
INFO:birdwatch.constants:Logging Prescoring Results RAM usage (after conversion) elapsed time: 0.02 secs (0.00 mins)

CONCAT WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in run_prescoring, at line 1398: prescoringRaterModelOutput = pd.concat(
  PandasTypeError: DataFrame concat on postSelectionValue: output=float64 inputs=[dtype('float64'), dtype('int64')] (allowed)

INFO:birdwatch.run_scoring:prescoringRaterModelOutput total RAM: 3958936 bytes (0.004 GB)
                                          column    dtype     RAM
0                             raterParticipantId   object  216928
1                         internalRaterIntercept  float32  108464
2                           internalRaterFactor1  float32  108464
3                         crhCrnhRatioDifference  float64  216928
4                                  meanNoteScore  float64  216928
5                                raterAgreeRatio  float64  216928
6                      aboveHelpfulnessThreshold  float64  216928
7                                     scorerName   object  216928
8                        internalRaterReputation  float64  216928
9                     lowDiligenceRaterIntercept  float32  108464
10                      lowDiligenceRaterFactor1  float32  108464
11                   lowDiligenceRaterReputation  float32  108464
12              lowDiligenceRaterInterceptRound2  float32  108464
13                incorrectTagRatingsMadeByRater     Int8   54232
14                       totalRatingsMadeByRater  float64  216928
15                            postSelectionValue  float64  216928
16                  successfulRatingHelpfulCount  float64  216928
17               successfulRatingNotHelpfulCount  float64  216928
18                unsuccessfulRatingHelpfulCount  float64  216928
19             unsuccessfulRatingNotHelpfulCount  float64  216928
20                 totalHelpfulHarassmentPenalty  float64  216928
21  raterAgreeRatioKeyWithHarassmentAbusePenalty  float64  216928
INFO:birdwatch.constants:Logging Prescoring Results RAM usage (after concatenation) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Fitting pflip model elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.run_scoring:We invoked run_scoring and are now in between prescoring and scoring.
INFO:birdwatch.run_scoring:Starting final scoring
INFO:birdwatch.run_scoring:notes total RAM: 2917075 bytes (0.003 GB)
                                    column     dtype     RAM
0                                   noteId     int64  295400
1                  noteAuthorParticipantId    object  295400
2                          createdAtMillis     int64  295400
3                                  tweetId    object  295400
4                           classification    object  295400
5                               believable  category   36925
6                                  harmful  category   36925
7                     validationDifficulty  category   36925
8                          misleadingOther      Int8   73850
9                   misleadingFactualError      Int8   73850
10              misleadingManipulatedMedia      Int8   73850
11           misleadingOutdatedInformation      Int8   73850
12       misleadingMissingImportantContext      Int8   73850
13         misleadingUnverifiedClaimAsFact      Int8   73850
14                        misleadingSatire      Int8   73850
15                      notMisleadingOther      Int8   73850
16           notMisleadingFactuallyCorrect      Int8   73850
17  notMisleadingOutdatedButNotWhenWritten      Int8   73850
18              notMisleadingClearlySatire      Int8   73850
19            notMisleadingPersonalOpinion      Int8   73850
20                      trustworthySources      Int8   73850
21                                 summary    object  295400
22                             isMediaNote      Int8   73850
INFO:birdwatch.run_scoring:ratings total RAM: 35361348 bytes (0.035 GB)
                                  column     dtype      RAM
0                                 noteId     int64  2946768
1                     raterParticipantId    object  2946768
2                        createdAtMillis     int64  2946768
3                                version      Int8   736692
4                                  agree      Int8   736692
5                               disagree      Int8   736692
6                                helpful      Int8   736692
7                             notHelpful      Int8   736692
8                       helpfulnessLevel  category   368478
9                           helpfulOther      Int8   736692
10                    helpfulInformative      Int8   736692
11                          helpfulClear      Int8   736692
12                     helpfulEmpathetic      Int8   736692
13                    helpfulGoodSources      Int8   736692
14                  helpfulUniqueContext      Int8   736692
15                 helpfulAddressesClaim      Int8   736692
16               helpfulImportantContext      Int8   736692
17               helpfulUnbiasedLanguage      Int8   736692
18                       notHelpfulOther      Int8   736692
19                   notHelpfulIncorrect      Int8   736692
20  notHelpfulSourcesMissingOrUnreliable      Int8   736692
21    notHelpfulOpinionSpeculationOrBias      Int8   736692
22            notHelpfulMissingKeyPoints      Int8   736692
23                    notHelpfulOutdated      Int8   736692
24            notHelpfulHardToUnderstand      Int8   736692
25       notHelpfulArgumentativeOrBiased      Int8   736692
26                    notHelpfulOffTopic      Int8   736692
27       notHelpfulSpamHarassmentOrAbuse      Int8   736692
28           notHelpfulIrrelevantSources      Int8   736692
29          notHelpfulOpinionSpeculation      Int8   736692
30               notHelpfulNoteNotNeeded      Int8   736692
31                        ratedOnTweetId     int64  2946768
32                            helpfulNum   float64  2946768
33                       highVolumeRater      bool   368346
INFO:birdwatch.run_scoring:noteStatusHistory total RAM: 4763502 bytes (0.005 GB)
                                            column     dtype     RAM
0                                           noteId     int64  295408
1                          noteAuthorParticipantId    object  295408
2                                  createdAtMillis   float64  295408
3               timestampMillisOfFirstNonNMRStatus   float64  295408
4                                firstNonNMRStatus  category   36926
5                   timestampMillisOfCurrentStatus   float64  295408
6                                    currentStatus  category   36934
7              timestampMillisOfLatestNonNMRStatus   float64  295408
8                           mostRecentNonNMRStatus  category   36926
9                      timestampMillisOfStatusLock   float64  295408
10                                    lockedStatus  category   36934
11                      timestampMillisOfRetroLock   float64  295408
12                               currentCoreStatus  category   36934
13                          currentExpansionStatus  category   36934
14                              currentGroupStatus  category   36934
15                                currentDecidedBy  category   36934
16                            currentModelingGroup   float64  295408
17         timestampMillisOfMostRecentStatusChange   float64  295408
18       timestampMillisOfNmrDueToMinStableCrhTime   float64  295408
19                         currentMultiGroupStatus  category   36926
20                       currentModelingMultiGroup   float64  295408
21             timestampMinuteOfFinalScoringOutput   float64  295408
22  timestampMillisOfFirstNmrDueToMinStableCrhTime   float64  295408
23                                  classification    object  295408
INFO:birdwatch.run_scoring:userEnrollment total RAM: 1052399 bytes (0.001 GB)
                           column     dtype     RAM
0                   participantId    object  147704
1                 enrollmentState    object  147704
2  successfulRatingNeededToEarnIn     int64  147704
3      timestampOfLastStateChange     int64  147704
4          timestampOfLastEarnOut   float64  147704
5              modelingPopulation  category   18471
6                   modelingGroup   float64  147704
7          numberOfTimesEarnedOut     int64  147704
INFO:birdwatch.run_scoring:prescoringNoteModelOutput total RAM: 1864772 bytes (0.002 GB)
                            column    dtype     RAM
0                           noteId    int64  286888
1            internalNoteIntercept  float32  143444
2              internalNoteFactor1  float32  143444
3                       scorerName   object  286888
4        lowDiligenceNoteIntercept  float32  143444
5          lowDiligenceNoteFactor1  float32  143444
6  lowDiligenceNoteInterceptRound2  float32  143444
7          harassmentNoteIntercept  float64  286888
8            harassmentNoteFactor1  float64  286888
INFO:birdwatch.run_scoring:prescoringRaterModelOutput total RAM: 3958936 bytes (0.004 GB)
                                          column    dtype     RAM
0                             raterParticipantId   object  216928
1                         internalRaterIntercept  float32  108464
2                           internalRaterFactor1  float32  108464
3                         crhCrnhRatioDifference  float64  216928
4                                  meanNoteScore  float64  216928
5                                raterAgreeRatio  float64  216928
6                      aboveHelpfulnessThreshold  float64  216928
7                                     scorerName   object  216928
8                        internalRaterReputation  float64  216928
9                     lowDiligenceRaterIntercept  float32  108464
10                      lowDiligenceRaterFactor1  float32  108464
11                   lowDiligenceRaterReputation  float32  108464
12              lowDiligenceRaterInterceptRound2  float32  108464
13                incorrectTagRatingsMadeByRater     Int8   54232
14                       totalRatingsMadeByRater  float64  216928
15                            postSelectionValue  float64  216928
16                  successfulRatingHelpfulCount  float64  216928
17               successfulRatingNotHelpfulCount  float64  216928
18                unsuccessfulRatingHelpfulCount  float64  216928
19             unsuccessfulRatingNotHelpfulCount  float64  216928
20                 totalHelpfulHarassmentPenalty  float64  216928
21  raterAgreeRatioKeyWithHarassmentAbusePenalty  float64  216928
INFO:birdwatch.constants:Logging Final Scoring RAM usage elapsed time: 0.02 secs (0.00 mins)
INFO:birdwatch.run_scoring:No previous scored notes passed; scoring all notes.
INFO:birdwatch.run_scoring:2. Rescore all recently created notes if not rescored at the minimum frequency.
INFO:birdwatch.run_scoring:Num notes created recently: 0
INFO:birdwatch.run_scoring:3. Rescore all notes that flipped status in the previous scoring run. 0
INFO:birdwatch.run_scoring:4. Rescore all recently-flipped notes if not rescored at the minimum frequency.
INFO:birdwatch.run_scoring:Num notes flipped recently: 0
INFO:birdwatch.run_scoring:Num notes not rescored recently enough: 1
INFO:birdwatch.run_scoring:5. Rescore all notes that were NMRed due to MinStableCrhTime was not met. 0
INFO:birdwatch.run_scoring:6. Rescore recent unlocked notes that are eligible for locking 0
INFO:birdwatch.run_scoring:----
Notes to rescore:
        * 0 notes with new ratings since last scoring run.
        * 0 notes created recently and not rescored recently enough.
        * 0 notes that flipped status in the previous scoring run.
        * 0 notes that flipped status recently and not rescored recently enough.
        * 0 notes that were NMRed due to MinStableCrhTime was not met.
        * 0 recent notes that are eligible to lock but haven't locked yet.
      Overall: 0 notes to rescore, out of 36925 total.
----
INFO:birdwatch.constants:Determine which notes to score. elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.process_data:Timestamp of latest rating in data: 2021-01-23 01:54:44.227000
INFO:birdwatch.process_data:Timestamp of latest note in data: 2021-01-23 01:54:44.227000
INFO:birdwatch.process_data:Total raters: 18463
INFO:birdwatch.process_data:Identifying high volume raters
INFO:birdwatch.process_data:Total ratings: 368346
INFO:birdwatch.process_data:High volume threshold for 7 days: 35.0
INFO:birdwatch.process_data:High volume raters for 7 days: 12
INFO:birdwatch.process_data:High volume threshold for 28 days: 35.0
INFO:birdwatch.process_data:High volume raters for 28 days: 12
INFO:birdwatch.process_data:Total high volume raters: 12
INFO:birdwatch.process_data:Total ratings: 368346
INFO:birdwatch.process_data:Total ratings from high volume raters: 443

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 31: newNoteStatusHistory = oldNoteStatusHistory.merge(
  PandasTypeError: Input mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)
  PandasTypeError: Output mismatch on createdAtMillis_notes: result=float64 expected=int64 (allowed)

INFO:birdwatch.note_status_history:total notes added to noteStatusHistory: 0

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 57: newNoteStatusHistory[[c.noteIdKey, c.createdAtMillisKey]].merge(
  PandasTypeError: Input mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)
  PandasTypeError: Merge key mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)


MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/process_data.py, in _filter_misleading_notes, at line 287: ratings = ratings.merge(
  PandasTypeError: Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

INFO:birdwatch.process_data:Preprocess Data: Filter misleading notes, starting with 368346 ratings on 36921 notes
INFO:birdwatch.process_data:  Keeping 368346 ratings on 36921 misleading notes
INFO:birdwatch.process_data:  Keeping 0 ratings on 0 deleted notes that were previously scored (in note status history)
INFO:birdwatch.process_data:  Removing 0 ratings on 0 older notes that aren't deleted, but are not-misleading.
INFO:birdwatch.process_data:  Removing 0 ratings on 0 notes that were deleted and not in note status history (e.g. old).
INFO:birdwatch.process_data:Num Ratings: 368346, Num Unique Notes Rated: 36921, Num Unique Raters: 18463
INFO:birdwatch.constants:Preprocess smaller dataset since we skipped preprocessing at read time elapsed time: 0.56 secs (0.01 mins)
INFO:birdwatch.constants:Set Note Topics to Dummy dataframe by copying all noteIds elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.run_scoring:Post Selection Similarity Final Scoring: begin with 368346 ratings.
INFO:birdwatch.run_scoring:Post Selection Similarity Final Scoring: 368346 ratings remaining.
INFO:birdwatch.constants:Post Selection Similarity: Final Scoring elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:score_final: Torch intra-op parallelism for MFCoreScorer set to: 12
INFO:birdwatch.scorer:Filtering ratings for MFCoreScorer.  Original rating length: 368346
INFO:birdwatch.scorer:  Ratings without assigned group: 0
INFO:birdwatch.scorer:  Ratings after group filter: 368346
INFO:birdwatch.scorer:MFCoreScorer Filter input elapsed time: 0.06 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:count debugging: 443, 367903, 443, 0
INFO:birdwatch.mf_base_scorer:Total Ratings vs Low Vol Ratings (MFCoreScorer): 368346 vs 367903
INFO:birdwatch.process_data:After applying min 0 ratings per rater and min 5 raters per note: 
Num Ratings: 364688, Num Unique Notes Rated: 35884, Num Unique Raters: 18463
INFO:birdwatch.scorer:MFCoreScorer Prepare ratings elapsed time: 0.08 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:Skipping rep-filtering in 2nd phase for MFCoreScorer
INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
INFO:birdwatch.wandb_utils:Reinitializing W&B run
INFO:birdwatch.wandb_utils:W&B is disabled
DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/Users/swu2/Development/communitynotes, stdin=None, shell=False, universal_newlines=False)
DEBUG:wandb:no default config file found in config-defaults.yaml
INFO:birdwatch.matrix_factorization:------------------
INFO:birdwatch.matrix_factorization:Users: 18355, Notes: 35884
INFO:birdwatch.matrix_factorization:initializing notes
/Users/swu2/Development/communitynotes/sourcecode/scoring/matrix_factorization/matrix_factorization.py:193: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  noteInit[c.internalNoteInterceptKey].fillna(0.0, inplace=True)
/Users/swu2/Development/communitynotes/sourcecode/scoring/matrix_factorization/matrix_factorization.py:199: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  noteInit[c.note_factor_key(i)].fillna(0.0, inplace=True)
INFO:birdwatch.matrix_factorization:initializing users
INFO:birdwatch.matrix_factorization:initialized global intercept
INFO:birdwatch.matrix_factorization:learning rate set to :0.2
INFO:birdwatch.matrix_factorization:cpu
INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 10.137860885074128
INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 19.819504222282756
INFO:birdwatch.matrix_factorization:Correcting loss function to simulate rating per note loss ratio = 10.141797495886896
INFO:birdwatch.model:Freezing parameter: user_factors.weight
INFO:birdwatch.model:Freezing parameter: user_intercepts.weight
INFO:birdwatch.model:Freezing parameter: global_intercept
INFO:birdwatch.matrix_factorization:epoch 0 0.1011861115694046
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0520486943423748
INFO:birdwatch.matrix_factorization:epoch 20 0.0680973082780838
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029652711004018784
INFO:birdwatch.matrix_factorization:epoch 40 0.06663665175437927
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.028979076072573662
INFO:birdwatch.matrix_factorization:epoch 60 0.06638579815626144
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02910602279007435
INFO:birdwatch.matrix_factorization:Num epochs: 73
INFO:birdwatch.matrix_factorization:epoch 73 0.06636057049036026
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02923022024333477
INFO:birdwatch.matrix_factorization:Global Intercept: 0.19005705416202545
INFO:birdwatch.wandb_utils:Finishing W&B run
INFO:birdwatch.scorer:MFCoreScorer Final helpfulness-filtered MF elapsed time: 0.78 secs (0.01 mins)
INFO:birdwatch.mf_base_scorer:About to call compute_scored_notes with MFCoreScorer

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_note_stats, at line 348: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on numRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on numRatingsLast28: result=float64 expected=int64 (allowed)

INFO:birdwatch.note_ratings:dropped 0 out of 367430 ratings due to NaN factor.

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 595: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on minSignCount: result=float64 expected=int32 (allowed)
  PandasTypeError: Output mismatch on netMinHelpful: result=float64 expected=int32 (allowed)


CONCAT WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 683: noteStats = tagAggregates.merge(noteStats, on=c.noteIdKey, how="outer")
  PandasTypeError: Type expectation mismatch on noteId: found=float64 expected=int64
  PandasTypeError: Type expectation mismatch on noteId: found=float64 expected=int64

INFO:birdwatch.constants:compute_scored_notes: compute tag aggregates elapsed time: 0.31 secs (0.01 mins)
/Users/swu2/Development/communitynotes/sourcecode/scoring/incorrect_filter.py:90: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  ratings_w_user_totals[c.incorrectTagRateByRaterKey].fillna(0, inplace=True)
/Users/swu2/Development/communitynotes/sourcecode/scoring/incorrect_filter.py:94: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  ratings_w_user_totals[c.incorrectTagRatingsMadeByRaterKey].fillna(0, inplace=True)
/Users/swu2/Development/communitynotes/sourcecode/scoring/incorrect_filter.py:98: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  ratings_w_user_totals[c.totalRatingsMadeByRaterKey].fillna(0, inplace=True)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 688: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on num_voters_interval: result=float64 expected=int64 (allowed)

INFO:birdwatch.constants:compute_scored_notes: compute incorrect aggregates elapsed time: 0.08 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 0.27 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:sn cols: Index(['noteId', 'ratingWeight', 'notHelpfulOtherAdjusted',
       'notHelpfulIncorrectAdjusted',
       'notHelpfulSourcesMissingOrUnreliableAdjusted',
       'notHelpfulOpinionSpeculationOrBiasAdjusted',
       'notHelpfulMissingKeyPointsAdjusted', 'notHelpfulOutdatedAdjusted',
       'notHelpfulHardToUnderstandAdjusted',
       'notHelpfulArgumentativeOrBiasedAdjusted', 'notHelpfulOffTopicAdjusted',
       'notHelpfulSpamHarassmentOrAbuseAdjusted',
       'notHelpfulIrrelevantSourcesAdjusted',
       'notHelpfulOpinionSpeculationAdjusted',
       'notHelpfulNoteNotNeededAdjusted', 'notHelpfulOtherAdjustedRatio',
       'notHelpfulIncorrectAdjustedRatio',
       'notHelpfulSourcesMissingOrUnreliableAdjustedRatio',
       'notHelpfulOpinionSpeculationOrBiasAdjustedRatio',
       'notHelpfulMissingKeyPointsAdjustedRatio',
       'notHelpfulOutdatedAdjustedRatio',
       'notHelpfulHardToUnderstandAdjustedRatio',
       'notHelpfulArgumentativeOrBiasedAdjustedRatio',
       'notHelpfulOffTopicAdjustedRatio',
       'notHelpfulSpamHarassmentOrAbuseAdjustedRatio',
       'notHelpfulIrrelevantSourcesAdjustedRatio',
       'notHelpfulOpinionSpeculationAdjustedRatio',
       'notHelpfulNoteNotNeededAdjustedRatio', 'helpfulOther',
       'helpfulInformative', 'helpfulClear', 'helpfulEmpathetic',
       'helpfulGoodSources', 'helpfulUniqueContext', 'helpfulAddressesClaim',
       'helpfulImportantContext', 'helpfulUnbiasedLanguage', 'notHelpfulOther',
       'notHelpfulIncorrect', 'notHelpfulSourcesMissingOrUnreliable',
       'notHelpfulOpinionSpeculationOrBias', 'notHelpfulMissingKeyPoints',
       'notHelpfulOutdated', 'notHelpfulHardToUnderstand',
       'notHelpfulArgumentativeOrBiased', 'notHelpfulOffTopic',
       'notHelpfulSpamHarassmentOrAbuse', 'notHelpfulIrrelevantSources',
       'notHelpfulOpinionSpeculation', 'notHelpfulNoteNotNeeded', 'numRatings',
       'noteAuthorParticipantId', 'classification', 'currentStatus',
       'internalNoteIntercept', 'internalNoteFactor1',
       'internalNoteFactor1_max', 'internalNoteFactor1_median',
       'internalNoteFactor1_min', 'internalNoteFactor1_refit_orig',
       'internalNoteIntercept_median', 'internalNoteIntercept_refit_orig',
       'ratingCount_all', 'ratingCount_neg_fac', 'ratingCount_pos_fac',
       'internalNoteIntercept_max', 'internalNoteIntercept_min',
       'notHelpfulIncorrect_interval', 'p_incorrect_user_interval',
       'num_voters_interval', 'tf_idf_incorrect_interval',
       'internalRatingStatus', 'internalActiveRules', 'crhBool', 'crnhBool',
       'awaitingBool'],
      dtype='object')
INFO:birdwatch.scorer:MFCoreScorer Final compute scored notes elapsed time: 1.80 secs (0.03 mins)
INFO:birdwatch.mf_base_scorer:noteScoresNoHighVol Summary MFCoreScorer: length (36926), cols (noteId, ratingWeight, notHelpfulOtherAdjusted, notHelpfulIncorrectAdjusted, notHelpfulSourcesMissingOrUnreliableAdjusted, notHelpfulOpinionSpeculationOrBiasAdjusted, notHelpfulMissingKeyPointsAdjusted, notHelpfulOutdatedAdjusted, notHelpfulHardToUnderstandAdjusted, notHelpfulArgumentativeOrBiasedAdjusted, notHelpfulOffTopicAdjusted, notHelpfulSpamHarassmentOrAbuseAdjusted, notHelpfulIrrelevantSourcesAdjusted, notHelpfulOpinionSpeculationAdjusted, notHelpfulNoteNotNeededAdjusted, notHelpfulOtherAdjustedRatio, notHelpfulIncorrectAdjustedRatio, notHelpfulSourcesMissingOrUnreliableAdjustedRatio, notHelpfulOpinionSpeculationOrBiasAdjustedRatio, notHelpfulMissingKeyPointsAdjustedRatio, notHelpfulOutdatedAdjustedRatio, notHelpfulHardToUnderstandAdjustedRatio, notHelpfulArgumentativeOrBiasedAdjustedRatio, notHelpfulOffTopicAdjustedRatio, notHelpfulSpamHarassmentOrAbuseAdjustedRatio, notHelpfulIrrelevantSourcesAdjustedRatio, notHelpfulOpinionSpeculationAdjustedRatio, notHelpfulNoteNotNeededAdjustedRatio, helpfulOther, helpfulInformative, helpfulClear, helpfulEmpathetic, helpfulGoodSources, helpfulUniqueContext, helpfulAddressesClaim, helpfulImportantContext, helpfulUnbiasedLanguage, notHelpfulOther, notHelpfulIncorrect, notHelpfulSourcesMissingOrUnreliable, notHelpfulOpinionSpeculationOrBias, notHelpfulMissingKeyPoints, notHelpfulOutdated, notHelpfulHardToUnderstand, notHelpfulArgumentativeOrBiased, notHelpfulOffTopic, notHelpfulSpamHarassmentOrAbuse, notHelpfulIrrelevantSources, notHelpfulOpinionSpeculation, notHelpfulNoteNotNeeded, numRatings, noteAuthorParticipantId, classification, currentStatus, internalNoteIntercept, internalNoteFactor1, internalNoteFactor1_max, internalNoteFactor1_median, internalNoteFactor1_min, internalNoteFactor1_refit_orig, internalNoteIntercept_median, internalNoteIntercept_refit_orig, ratingCount_all, ratingCount_neg_fac, ratingCount_pos_fac, internalNoteIntercept_max, internalNoteIntercept_min, notHelpfulIncorrect_interval, p_incorrect_user_interval, num_voters_interval, tf_idf_incorrect_interval, internalRatingStatus, internalActiveRules, crhBool, crnhBool, awaitingBool)
INFO:birdwatch.process_data:After applying min 0 ratings per rater and min 5 raters per note: 
Num Ratings: 364688, Num Unique Notes Rated: 35884, Num Unique Raters: 18463
INFO:birdwatch.scorer:MFCoreScorer Prepare ratings elapsed time: 0.09 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:Skipping rep-filtering in 2nd phase for MFCoreScorer
INFO:birdwatch.matrix_factorization:Reinitializing wandb run with enabled state: False
INFO:birdwatch.wandb_utils:Reinitializing W&B run
INFO:birdwatch.wandb_utils:W&B is disabled
DEBUG:git.cmd:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/Users/swu2/Development/communitynotes, stdin=None, shell=False, universal_newlines=False)
DEBUG:wandb:no default config file found in config-defaults.yaml
INFO:birdwatch.matrix_factorization:------------------
INFO:birdwatch.matrix_factorization:Users: 18355, Notes: 35884
INFO:birdwatch.matrix_factorization:initializing notes
/Users/swu2/Development/communitynotes/sourcecode/scoring/matrix_factorization/matrix_factorization.py:193: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  noteInit[c.internalNoteInterceptKey].fillna(0.0, inplace=True)
/Users/swu2/Development/communitynotes/sourcecode/scoring/matrix_factorization/matrix_factorization.py:199: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  noteInit[c.note_factor_key(i)].fillna(0.0, inplace=True)
INFO:birdwatch.matrix_factorization:initializing users
INFO:birdwatch.matrix_factorization:initialized global intercept
INFO:birdwatch.matrix_factorization:learning rate set to :0.2
INFO:birdwatch.matrix_factorization:cpu
INFO:birdwatch.matrix_factorization:Ratings per note in dataset: 10.137860885074128
INFO:birdwatch.matrix_factorization:Ratings per user in dataset: 19.819504222282756
INFO:birdwatch.matrix_factorization:Correcting loss function to simulate rating per note loss ratio = 10.141797495886896
INFO:birdwatch.model:Freezing parameter: user_factors.weight
INFO:birdwatch.model:Freezing parameter: user_intercepts.weight
INFO:birdwatch.model:Freezing parameter: global_intercept
INFO:birdwatch.matrix_factorization:epoch 0 0.1011861115694046
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.0520486943423748
INFO:birdwatch.matrix_factorization:epoch 20 0.0680973082780838
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.029652711004018784
INFO:birdwatch.matrix_factorization:epoch 40 0.06663665175437927
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.028979076072573662
INFO:birdwatch.matrix_factorization:epoch 60 0.06638579815626144
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02910602279007435
INFO:birdwatch.matrix_factorization:Num epochs: 73
INFO:birdwatch.matrix_factorization:epoch 73 0.06636057049036026
INFO:birdwatch.matrix_factorization:TRAIN FIT LOSS: 0.02923022024333477
INFO:birdwatch.matrix_factorization:Global Intercept: 0.19005705416202545
INFO:birdwatch.wandb_utils:Finishing W&B run
INFO:birdwatch.scorer:MFCoreScorer Final helpfulness-filtered MF elapsed time: 0.75 secs (0.01 mins)
INFO:birdwatch.mf_base_scorer:About to call compute_scored_notes with MFCoreScorer

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_note_stats, at line 348: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on numRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on numRatingsLast28: result=float64 expected=int64 (allowed)

INFO:birdwatch.note_ratings:dropped 0 out of 367430 ratings due to NaN factor.

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 595: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on minSignCount: result=float64 expected=int32 (allowed)
  PandasTypeError: Output mismatch on netMinHelpful: result=float64 expected=int32 (allowed)


CONCAT WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 683: noteStats = tagAggregates.merge(noteStats, on=c.noteIdKey, how="outer")
  PandasTypeError: Type expectation mismatch on noteId: found=float64 expected=int64
  PandasTypeError: Type expectation mismatch on noteId: found=float64 expected=int64

INFO:birdwatch.constants:compute_scored_notes: compute tag aggregates elapsed time: 0.26 secs (0.00 mins)
/Users/swu2/Development/communitynotes/sourcecode/scoring/incorrect_filter.py:90: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  ratings_w_user_totals[c.incorrectTagRateByRaterKey].fillna(0, inplace=True)
/Users/swu2/Development/communitynotes/sourcecode/scoring/incorrect_filter.py:94: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  ratings_w_user_totals[c.incorrectTagRatingsMadeByRaterKey].fillna(0, inplace=True)
/Users/swu2/Development/communitynotes/sourcecode/scoring/incorrect_filter.py:98: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  ratings_w_user_totals[c.totalRatingsMadeByRaterKey].fillna(0, inplace=True)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 688: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on num_voters_interval: result=float64 expected=int64 (allowed)

INFO:birdwatch.constants:compute_scored_notes: compute incorrect aggregates elapsed time: 0.08 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: InitialNMR (v1.0)
INFO:birdwatch.constants:Calling score_notes: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: InitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRH (v1.0)
INFO:birdwatch.constants:Calling score_notes: GeneralCRH (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: GeneralCRH (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: GeneralCRNH (v1.0)
INFO:birdwatch.constants:Calling score_notes: GeneralCRNH (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: GeneralCRNH (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 0.27 secs (0.00 mins)
INFO:birdwatch.mf_base_scorer:sn cols: Index(['noteId', 'ratingWeight', 'notHelpfulOtherAdjusted',
       'notHelpfulIncorrectAdjusted',
       'notHelpfulSourcesMissingOrUnreliableAdjusted',
       'notHelpfulOpinionSpeculationOrBiasAdjusted',
       'notHelpfulMissingKeyPointsAdjusted', 'notHelpfulOutdatedAdjusted',
       'notHelpfulHardToUnderstandAdjusted',
       'notHelpfulArgumentativeOrBiasedAdjusted', 'notHelpfulOffTopicAdjusted',
       'notHelpfulSpamHarassmentOrAbuseAdjusted',
       'notHelpfulIrrelevantSourcesAdjusted',
       'notHelpfulOpinionSpeculationAdjusted',
       'notHelpfulNoteNotNeededAdjusted', 'notHelpfulOtherAdjustedRatio',
       'notHelpfulIncorrectAdjustedRatio',
       'notHelpfulSourcesMissingOrUnreliableAdjustedRatio',
       'notHelpfulOpinionSpeculationOrBiasAdjustedRatio',
       'notHelpfulMissingKeyPointsAdjustedRatio',
       'notHelpfulOutdatedAdjustedRatio',
       'notHelpfulHardToUnderstandAdjustedRatio',
       'notHelpfulArgumentativeOrBiasedAdjustedRatio',
       'notHelpfulOffTopicAdjustedRatio',
       'notHelpfulSpamHarassmentOrAbuseAdjustedRatio',
       'notHelpfulIrrelevantSourcesAdjustedRatio',
       'notHelpfulOpinionSpeculationAdjustedRatio',
       'notHelpfulNoteNotNeededAdjustedRatio', 'helpfulOther',
       'helpfulInformative', 'helpfulClear', 'helpfulEmpathetic',
       'helpfulGoodSources', 'helpfulUniqueContext', 'helpfulAddressesClaim',
       'helpfulImportantContext', 'helpfulUnbiasedLanguage', 'notHelpfulOther',
       'notHelpfulIncorrect', 'notHelpfulSourcesMissingOrUnreliable',
       'notHelpfulOpinionSpeculationOrBias', 'notHelpfulMissingKeyPoints',
       'notHelpfulOutdated', 'notHelpfulHardToUnderstand',
       'notHelpfulArgumentativeOrBiased', 'notHelpfulOffTopic',
       'notHelpfulSpamHarassmentOrAbuse', 'notHelpfulIrrelevantSources',
       'notHelpfulOpinionSpeculation', 'notHelpfulNoteNotNeeded', 'numRatings',
       'noteAuthorParticipantId', 'classification', 'currentStatus',
       'internalNoteIntercept', 'internalNoteFactor1',
       'internalNoteFactor1_max', 'internalNoteFactor1_median',
       'internalNoteFactor1_min', 'internalNoteFactor1_refit_orig',
       'internalNoteIntercept_median', 'internalNoteIntercept_refit_orig',
       'ratingCount_all', 'ratingCount_neg_fac', 'ratingCount_pos_fac',
       'internalNoteIntercept_max', 'internalNoteIntercept_min',
       'internalNoteInterceptNoHighVol', 'notHelpfulIncorrect_interval',
       'p_incorrect_user_interval', 'num_voters_interval',
       'tf_idf_incorrect_interval', 'internalRatingStatus',
       'internalActiveRules', 'crhBool', 'crnhBool', 'awaitingBool'],
      dtype='object')
INFO:birdwatch.scorer:MFCoreScorer Final compute scored notes elapsed time: 1.77 secs (0.03 mins)
INFO:birdwatch.mf_base_scorer:noteScores Summary MFCoreScorer: length (36926), cols (noteId, ratingWeight, notHelpfulOtherAdjusted, notHelpfulIncorrectAdjusted, notHelpfulSourcesMissingOrUnreliableAdjusted, notHelpfulOpinionSpeculationOrBiasAdjusted, notHelpfulMissingKeyPointsAdjusted, notHelpfulOutdatedAdjusted, notHelpfulHardToUnderstandAdjusted, notHelpfulArgumentativeOrBiasedAdjusted, notHelpfulOffTopicAdjusted, notHelpfulSpamHarassmentOrAbuseAdjusted, notHelpfulIrrelevantSourcesAdjusted, notHelpfulOpinionSpeculationAdjusted, notHelpfulNoteNotNeededAdjusted, notHelpfulOtherAdjustedRatio, notHelpfulIncorrectAdjustedRatio, notHelpfulSourcesMissingOrUnreliableAdjustedRatio, notHelpfulOpinionSpeculationOrBiasAdjustedRatio, notHelpfulMissingKeyPointsAdjustedRatio, notHelpfulOutdatedAdjustedRatio, notHelpfulHardToUnderstandAdjustedRatio, notHelpfulArgumentativeOrBiasedAdjustedRatio, notHelpfulOffTopicAdjustedRatio, notHelpfulSpamHarassmentOrAbuseAdjustedRatio, notHelpfulIrrelevantSourcesAdjustedRatio, notHelpfulOpinionSpeculationAdjustedRatio, notHelpfulNoteNotNeededAdjustedRatio, helpfulOther, helpfulInformative, helpfulClear, helpfulEmpathetic, helpfulGoodSources, helpfulUniqueContext, helpfulAddressesClaim, helpfulImportantContext, helpfulUnbiasedLanguage, notHelpfulOther, notHelpfulIncorrect, notHelpfulSourcesMissingOrUnreliable, notHelpfulOpinionSpeculationOrBias, notHelpfulMissingKeyPoints, notHelpfulOutdated, notHelpfulHardToUnderstand, notHelpfulArgumentativeOrBiased, notHelpfulOffTopic, notHelpfulSpamHarassmentOrAbuse, notHelpfulIrrelevantSources, notHelpfulOpinionSpeculation, notHelpfulNoteNotNeeded, numRatings, noteAuthorParticipantId, classification, currentStatus, internalNoteIntercept, internalNoteFactor1, internalNoteFactor1_max, internalNoteFactor1_median, internalNoteFactor1_min, internalNoteFactor1_refit_orig, internalNoteIntercept_median, internalNoteIntercept_refit_orig, ratingCount_all, ratingCount_neg_fac, ratingCount_pos_fac, internalNoteIntercept_max, internalNoteIntercept_min, internalNoteInterceptNoHighVol, notHelpfulIncorrect_interval, p_incorrect_user_interval, num_voters_interval, tf_idf_incorrect_interval, internalRatingStatus, internalActiveRules, crhBool, crnhBool, awaitingBool)
INFO:birdwatch.scorer:Postprocessing output for MFCoreScorer
INFO:birdwatch.scorer:  Original noteScores length: 36926
INFO:birdwatch.scorer:  Final noteScores length: 36921
INFO:birdwatch.scorer:MFCoreScorer Postprocess output elapsed time: 0.13 secs (0.00 mins)
INFO:birdwatch.run_scoring:----
    Completed individual scorers. Ran in parallel: False.  Succeeded in 5.61 seconds. 
    Individual scorers: (name, runtime): [('MFCoreScorer', '0.09 mins')]
    ----

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in _merge_results, at line 293: scoredNotes = scoredNotes.merge(
  PandasTypeError: Output mismatch on coreNumFinalRoundRatings: result=float64 expected=int64 (UNALLOWED)


MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_note_stats, at line 348: noteStats = noteStats.merge(
  PandasTypeError: Output mismatch on numRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on numRatingsLast28: result=float64 expected=int64 (allowed)

INFO:birdwatch.constants:Post-scorers: Compute note stats elapsed time: 0.05 secs (0.00 mins)
INFO:birdwatch.constants:Post-scorers: Meta Score: Setup elapsed time: 0.02 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: MetaInitialNMR (v1.0)
INFO:birdwatch.constants:Calling score_notes: MetaInitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: MetaInitialNMR (v1.0) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: CoreModel (v1.1)
INFO:birdwatch.constants:Calling score_notes: CoreModel (v1.1) elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Applying scoring rule: CoreModel (v1.1) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.scoring_rules:Applying scoring rule: ScoringDriftGuard (v1.0)
INFO:birdwatch.constants:Calling score_notes: ScoringDriftGuard (v1.0) elapsed time: 0.00 secs (0.00 mins)

CONCAT WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/scoring_rules.py, in apply_scoring_rules, at line 1453: pd.concat([noteLabels, noteStatusUpdates], unsafeAllowed=unsafeAllowed)
  PandasTypeError: DataFrame concat on finalRatingStatus: output=object inputs=[dtype('O'), CategoricalDtype(categories=['NEEDS_MORE_RATINGS'], ordered=False, categories_dtype=object)] (allowed)

INFO:birdwatch.constants:Applying scoring rule: ScoringDriftGuard (v1.0) elapsed time: 0.01 secs (0.00 mins)
INFO:birdwatch.constants:Condense noteRules after applying all scoring rules elapsed time: 0.32 secs (0.01 mins)
INFO:birdwatch.constants:Post-scorers: Meta Score: Apply Scoring Rules elapsed time: 0.34 secs (0.01 mins)
INFO:birdwatch.constants:Post-scorers: Meta Score: Preparing Return Values elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Post-scorers: Meta score elapsed time: 0.36 secs (0.01 mins)
INFO:birdwatch.constants:Post-scorers: Join scored notes elapsed time: 0.02 secs (0.00 mins)
WARNING:birdwatch.note_status_history:Column expansionRatingStatus not found in scoredNotes, skipping it.
WARNING:birdwatch.note_status_history:Column groupRatingStatus not found in scoredNotes, skipping it.
WARNING:birdwatch.note_status_history:Column modelingGroup not found in scoredNotes, skipping it.
WARNING:birdwatch.note_status_history:Column multiGroupRatingStatus not found in scoredNotes, skipping it.
WARNING:birdwatch.note_status_history:Column modelingMultiGroup not found in scoredNotes, skipping it.

INIT WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in update_note_status_history, at line 406: newNoteStatusHistory = mergedStatuses.apply(apply_update, axis=1)
  PandasTypeError: Type expectation mismatch on noteId: found=object expected=int64

INFO:birdwatch.constants:Post-scorers: Update note status history elapsed time: 3.81 secs (0.06 mins)
INFO:birdwatch.constants:Post-scorers: finalize output columns elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.run_scoring:Meta scoring elapsed time: 0.07 minutes.
INFO:birdwatch.run_scoring:Starting contributor scoring
INFO:birdwatch.constants:Meta Helpfulness Scorers: Setup elapsed time: 0.03 secs (0.00 mins)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in get_ratings_before_note_status_and_public_tsv, at line 94: ratingsWithNoteLabelInfo = ratings[
  PandasTypeError: Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

INFO:birdwatch.note_ratings:Total ratings: 0 post-tombstones and 368346 pre-tombstones
INFO:birdwatch.note_ratings:Total ratings created before statuses: 183078, including 0 post-tombstones and 183078 pre-tombstones.
INFO:birdwatch.note_ratings:Total valid ratings: 38676

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in get_ratings_before_note_status_and_public_tsv, at line 94: ratingsWithNoteLabelInfo = ratings[
  PandasTypeError: Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

INFO:birdwatch.note_ratings:Total ratings: 0 post-tombstones and 368346 pre-tombstones
INFO:birdwatch.note_ratings:Total ratings created before statuses: 183078, including 0 post-tombstones and 183078 pre-tombstones.
INFO:birdwatch.contributor_state:Calculating ratedAfterDecision:
INFO:birdwatch.contributor_state:  Total ratings: 368346
INFO:birdwatch.contributor_state:  Total ratings on notes with status: 0
INFO:birdwatch.contributor_state:  Total ratings after status: 0
INFO:birdwatch.contributor_state:  Total raters rating after decision: 0

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in _get_visible_rating_counts, at line 184: historyCounts = historyCounts.merge(
  PandasTypeError: Output mismatch on ratedAfterDecision: result=float64 expected=int64 (allowed)


MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in _get_visible_rating_counts, at line 194: ratingCounts = ratingCounts.merge(
  PandasTypeError: Output mismatch on successfulRatingHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on successfulRatingNotHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on successfulRatingTotal: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on unsuccessfulRatingHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on unsuccessfulRatingNotHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on unsuccessfulRatingTotal: result=float64 expected=int64 (allowed)


JOIN WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in get_contributor_scores, at line 641: visibleRatingCounts.join(
  PandasTypeError: Output mismatch on index: result=object expected=<class 'numpy.int64'> (allowed)
  PandasTypeError: Output mismatch on awaitingBoolnote: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on ratingsAwaitingMoreRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on crhBool: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on crnhBool: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on awaitingBoolrater: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on numRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on notesCurrentlyRatedHelpful: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on notesCurrentlyRatedNotHelpful: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on notesAwaitingMoreRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on aggregateRatingReceivedTotal: result=float64 expected=int64 (allowed)

INFO:birdwatch.contributor_state:Number Contributor Counts: 18457
INFO:birdwatch.constants:Meta Helpfulness Scores: Contributor Scores elapsed time: 0.43 secs (0.01 mins)
/Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py:463: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  scoredNotesWithLastEarnOut[c.timestampOfLastEarnOut].fillna(1, inplace=True)
INFO:birdwatch.constants:Contributor State: Setup elapsed time: 0.01 secs (0.00 mins)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in get_ratings_before_note_status_and_public_tsv, at line 94: ratingsWithNoteLabelInfo = ratings[
  PandasTypeError: Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

INFO:birdwatch.note_ratings:Total ratings: 0 post-tombstones and 368346 pre-tombstones
INFO:birdwatch.note_ratings:Total ratings created before statuses: 183078, including 0 post-tombstones and 183078 pre-tombstones.
INFO:birdwatch.note_ratings:Total valid ratings: 38676

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in get_ratings_before_note_status_and_public_tsv, at line 94: ratingsWithNoteLabelInfo = ratings[
  PandasTypeError: Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

INFO:birdwatch.note_ratings:Total ratings: 0 post-tombstones and 368346 pre-tombstones
INFO:birdwatch.note_ratings:Total ratings created before statuses: 183078, including 0 post-tombstones and 183078 pre-tombstones.
INFO:birdwatch.contributor_state:Calculating ratedAfterDecision:
INFO:birdwatch.contributor_state:  Total ratings: 368346
INFO:birdwatch.contributor_state:  Total ratings on notes with status: 0
INFO:birdwatch.contributor_state:  Total ratings after status: 0
INFO:birdwatch.contributor_state:  Total raters rating after decision: 0

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in _get_visible_rating_counts, at line 184: historyCounts = historyCounts.merge(
  PandasTypeError: Output mismatch on ratedAfterDecision: result=float64 expected=int64 (allowed)


MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in _get_visible_rating_counts, at line 194: ratingCounts = ratingCounts.merge(
  PandasTypeError: Output mismatch on successfulRatingHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on successfulRatingNotHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on successfulRatingTotal: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on unsuccessfulRatingHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on unsuccessfulRatingNotHelpfulCount: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on unsuccessfulRatingTotal: result=float64 expected=int64 (allowed)


JOIN WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in get_contributor_scores, at line 641: visibleRatingCounts.join(
  PandasTypeError: Output mismatch on index: result=object expected=<class 'numpy.int64'> (allowed)
  PandasTypeError: Output mismatch on awaitingBoolnote: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on ratingsAwaitingMoreRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on crhBool: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on crnhBool: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on awaitingBoolrater: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on numRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on notesCurrentlyRatedHelpful: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on notesCurrentlyRatedNotHelpful: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on notesAwaitingMoreRatings: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on aggregateRatingReceivedTotal: result=float64 expected=int64 (allowed)

INFO:birdwatch.contributor_state:Number Contributor Counts: 18457
INFO:birdwatch.constants:Contributor State: Contributor Scores elapsed time: 0.41 secs (0.01 mins)
INFO:birdwatch.constants:NH Tags: Top 2 per note elapsed time: 0.09 secs (0.00 mins)
INFO:birdwatch.constants:NH Tags: Top 2 per author elapsed time: 0.01 secs (0.00 mins)

INIT WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/explanation_tags.py, in get_top_nonhelpful_tags_per_author, at line 148: topTwoPerAuthor = authorTagsAgg.apply(_set_top_tags, axis=1).reset_index()[
  PandasTypeError: Type expectation mismatch on noteId: found=object expected=int64


APPLY WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/explanation_tags.py, in get_top_nonhelpful_tags_per_author, at line 148: topTwoPerAuthor = authorTagsAgg.apply(_set_top_tags, axis=1).reset_index()[
  PandasTypeError: Type expectation mismatch on noteId: found=object expected=int64

INFO:birdwatch.constants:NH Tags: Set Top Tags elapsed time: 0.00 secs (0.00 mins)
INFO:birdwatch.constants:Contributor State: Top NH Tags Per Author elapsed time: 0.11 secs (0.00 mins)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in get_contributor_state, at line 494: contributorScores = contributorScores.merge(
  PandasTypeError: Output mismatch on isEmergingWriter: result=object expected=bool (allowed)

INFO:birdwatch.constants:Contributor State: Emerging Writers elapsed time: 0.02 secs (0.00 mins)

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in get_contributor_state, at line 504: contributorScoresWithEnrollment = contributorScores.merge(
  PandasTypeError: Output mismatch on hasCrnhSinceEarnOut: result=object expected=bool (UNALLOWED)
  PandasTypeError: Output mismatch on successfulRatingNeededToEarnIn: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on timestampOfLastStateChange: result=float64 expected=int64 (allowed)
  PandasTypeError: Output mismatch on numberOfTimesEarnedOut: result=float64 expected=int64 (allowed)

/Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py:519: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  contributorScoresWithEnrollment.fillna(
/Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py:580: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  mappedUserEnrollment[c.enrollmentState] = mappedUserEnrollment[c.enrollmentState].map(
INFO:birdwatch.constants:Contributor State: Combining elapsed time: 0.04 secs (0.00 mins)
INFO:birdwatch.contributor_state:Enrollment State
INFO:birdwatch.contributor_state:Number of Earned In 1530
INFO:birdwatch.contributor_state:Number At Risk 0
INFO:birdwatch.contributor_state:Number of Earn Out No Ack 0
INFO:birdwatch.contributor_state:Number of Earned Out Ack 0
INFO:birdwatch.contributor_state:Number of New Users 16927
INFO:birdwatch.constants:Meta Helpfulness Scorers: Contributor State elapsed time: 0.59 secs (0.01 mins)
/Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py:100: FutureWarning: the convert_dtype parameter is deprecated and will be removed in a future version.  Do ``ser.astype(object).apply()`` instead if you want ``convert_dtype=False``.
  totalNotes = (

MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in _compute_helpfulness_scores, at line 1145: helpfulnessScores = helpfulnessScores.merge(
  PandasTypeError: Output mismatch on enrollmentState: result=float64 expected=int64 (UNALLOWED)
  PandasTypeError: Output mismatch on isEmergingWriter: result=object expected=bool (UNALLOWED)


MERGE WARNING(S) AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in _compute_helpfulness_scores, at line 1151: helpfulnessScores = helpfulnessScores.merge(
  PandasTypeError: Output mismatch on enrollmentState_prev: result=float64 expected=int64 (allowed)

/Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py:1166: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  helpfulnessScores[c.timestampOfLastEarnOut].fillna(1, inplace=True)
INFO:birdwatch.constants:Meta Helpfulness Scorers: Combining elapsed time: 0.16 secs (0.00 mins)
INFO:birdwatch.constants:Post-scorers: Compute helpfulness scores elapsed time: 1.20 secs (0.02 mins)

TYPE WARNING SUMMARY
APPLY: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/explanation_tags.py, in get_top_nonhelpful_tags_per_author, at line 148: topTwoPerAuthor = authorTagsAgg.apply(_set_top_tags, axis=1).reset_index()[
    1x  Type expectation mismatch on noteId: found=object expected=int64

CONCAT: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 683: noteStats = tagAggregates.merge(noteStats, on=c.noteIdKey, how="outer")
    4x  Type expectation mismatch on noteId: found=float64 expected=int64

CONCAT: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 31: newNoteStatusHistory = oldNoteStatusHistory.merge(
    2x  Type expectation mismatch on noteId: found=float64 expected=int64

CONCAT: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in run_prescoring, at line 1398: prescoringRaterModelOutput = pd.concat(
    1x  DataFrame concat on postSelectionValue: output=float64 inputs=[dtype('float64'), dtype('int64')] (allowed)

CONCAT: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/scoring_rules.py, in apply_scoring_rules, at line 1453: pd.concat([noteLabels, noteStatusUpdates], unsafeAllowed=unsafeAllowed)
    1x  DataFrame concat on finalRatingStatus: output=object inputs=[dtype('O'), CategoricalDtype(categories=['NEEDS_MORE_RATINGS'], ordered=False, categories_dtype=object)] (allowed)

INIT: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/explanation_tags.py, in get_top_nonhelpful_tags_per_author, at line 148: topTwoPerAuthor = authorTagsAgg.apply(_set_top_tags, axis=1).reset_index()[
    1x  Type expectation mismatch on noteId: found=object expected=int64

INIT: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in update_note_status_history, at line 406: newNoteStatusHistory = mergedStatuses.apply(apply_update, axis=1)
    1x  Type expectation mismatch on noteId: found=object expected=int64

JOIN: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in get_contributor_scores, at line 641: visibleRatingCounts.join(
    2x  Output mismatch on index: result=object expected=<class 'numpy.int64'> (allowed)
    2x  Output mismatch on awaitingBoolnote: result=float64 expected=int64 (allowed)
    2x  Output mismatch on ratingsAwaitingMoreRatings: result=float64 expected=int64 (allowed)
    2x  Output mismatch on crhBool: result=float64 expected=int64 (allowed)
    2x  Output mismatch on crnhBool: result=float64 expected=int64 (allowed)
    2x  Output mismatch on awaitingBoolrater: result=float64 expected=int64 (allowed)
    2x  Output mismatch on numRatings: result=float64 expected=int64 (allowed)
    2x  Output mismatch on notesCurrentlyRatedHelpful: result=float64 expected=int64 (allowed)
    2x  Output mismatch on notesCurrentlyRatedNotHelpful: result=float64 expected=int64 (allowed)
    2x  Output mismatch on notesAwaitingMoreRatings: result=float64 expected=int64 (allowed)
    2x  Output mismatch on aggregateRatingReceivedTotal: result=float64 expected=int64 (allowed)

MERGE: 4 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_note_stats, at line 348: noteStats = noteStats.merge(
    4x  Output mismatch on numRatings: result=float64 expected=int64 (allowed)
    4x  Output mismatch on numRatingsLast28: result=float64 expected=int64 (allowed)

MERGE: 4 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in get_ratings_before_note_status_and_public_tsv, at line 94: ratingsWithNoteLabelInfo = ratings[
    4x  Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

MERGE: 3 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 595: noteStats = noteStats.merge(
    3x  Output mismatch on minSignCount: result=float64 expected=int32 (allowed)
    3x  Output mismatch on netMinHelpful: result=float64 expected=int32 (allowed)

MERGE: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in _get_visible_rating_counts, at line 184: historyCounts = historyCounts.merge(
    2x  Output mismatch on ratedAfterDecision: result=float64 expected=int64 (allowed)

MERGE: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in _get_visible_rating_counts, at line 194: ratingCounts = ratingCounts.merge(
    2x  Output mismatch on successfulRatingHelpfulCount: result=float64 expected=int64 (allowed)
    2x  Output mismatch on successfulRatingNotHelpfulCount: result=float64 expected=int64 (allowed)
    2x  Output mismatch on successfulRatingTotal: result=float64 expected=int64 (allowed)
    2x  Output mismatch on unsuccessfulRatingHelpfulCount: result=float64 expected=int64 (allowed)
    2x  Output mismatch on unsuccessfulRatingNotHelpfulCount: result=float64 expected=int64 (allowed)
    2x  Output mismatch on unsuccessfulRatingTotal: result=float64 expected=int64 (allowed)

MERGE: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_ratings.py, in compute_scored_notes, at line 688: noteStats = noteStats.merge(
    2x  Output mismatch on num_voters_interval: result=float64 expected=int64 (allowed)

MERGE: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 31: newNoteStatusHistory = oldNoteStatusHistory.merge(
    1x  Output mismatch on createdAtMillis: result=float64 expected=int64 (allowed)
    2x  Output mismatch on createdAtMillis_notes: result=float64 expected=int64 (allowed)
    1x  Input mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)

MERGE: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/note_status_history.py, in merge_note_info, at line 57: newNoteStatusHistory[[c.noteIdKey, c.createdAtMillisKey]].merge(
    2x  Input mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)
    2x  Merge key mismatch on createdAtMillis: left=float64 vs right=int64 (allowed)

MERGE: 2 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/process_data.py, in _filter_misleading_notes, at line 287: ratings = ratings.merge(
    2x  Input mismatch on createdAtMillis: left=int64 vs right=float64 (allowed)

MERGE: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in get_contributor_state, at line 494: contributorScores = contributorScores.merge(
    1x  Output mismatch on isEmergingWriter: result=object expected=bool (allowed)

MERGE: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/contributor_state.py, in get_contributor_state, at line 504: contributorScoresWithEnrollment = contributorScores.merge(
    1x  Output mismatch on hasCrnhSinceEarnOut: result=object expected=bool (UNALLOWED)
    1x  Output mismatch on successfulRatingNeededToEarnIn: result=float64 expected=int64 (allowed)
    1x  Output mismatch on timestampOfLastStateChange: result=float64 expected=int64 (allowed)
    1x  Output mismatch on numberOfTimesEarnedOut: result=float64 expected=int64 (allowed)

MERGE: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/mf_base_scorer.py, in _prescore_notes_and_users, at line 973: raterModelOutput = raterParams.merge(
    1x  Output mismatch on totalRatingsMadeByRater: result=float64 expected=int64 (allowed)

MERGE: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in _compute_helpfulness_scores, at line 1145: helpfulnessScores = helpfulnessScores.merge(
    1x  Output mismatch on enrollmentState: result=float64 expected=int64 (UNALLOWED)
    1x  Output mismatch on isEmergingWriter: result=object expected=bool (UNALLOWED)

MERGE: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in _compute_helpfulness_scores, at line 1151: helpfulnessScores = helpfulnessScores.merge(
    1x  Output mismatch on enrollmentState_prev: result=float64 expected=int64 (allowed)

MERGE: 1 BAD CALLS AT: /Users/swu2/Development/communitynotes/sourcecode/scoring/run_scoring.py, in _merge_results, at line 293: scoredNotes = scoredNotes.merge(
    1x  Output mismatch on coreNumFinalRoundRatings: result=float64 expected=int64 (UNALLOWED)

Patching pandas
Pairs dict used 0.08388616800000001GB RAM at max
Pairs dict used 0.08388616800000001GB RAM after deleted unneeded pairs
MallocNanoZone: 0
COMMAND_MODE: unix2003
__CFBundleIdentifier: com.microsoft.VSCode
PATH: /Users/swu2/Development/communitynotes/.venv/bin:/opt/homebrew/opt/postgresql@15/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/swu2/.vscode/extensions/ms-python.python-2025.6.0-darwin-arm64/python_files/deactivate/zsh:/Users/swu2/Development/communitynotes/.venv/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Library/Apple/usr/bin:/Library/TeX/texbin:/opt/homebrew/opt/postgresql@15/bin:/opt/homebrew/bin:/opt/homebrew/sbin:/Users/swu2/.vscode/extensions/ms-python.debugpy-2025.10.0-darwin-arm64/bundled/scripts/noConfigScripts:/Users/swu2/Library/Application Support/Code/User/globalStorage/github.copilot-chat/debugCommand
XPC_SERVICE_NAME: 0
SSH_AUTH_SOCK: /private/tmp/com.apple.launchd.To9ONbm614/Listeners
XPC_FLAGS: 0x0
LOGNAME: swu2
USER: swu2
HOME: /Users/swu2
SHELL: /bin/zsh
TMPDIR: /var/folders/dh/w8mydj5n36g_3vvhz9yhrrzh0000gq/T/
__CF_USER_TEXT_ENCODING: 0x1F7:0x0:0x0
ORIGINAL_XDG_CURRENT_DESKTOP: undefined
SHLVL: 1
PWD: /Users/swu2/Development/communitynotes/sourcecode
OLDPWD: /Users/swu2/Development/communitynotes/sourcecode/data
HOMEBREW_PREFIX: /opt/homebrew
HOMEBREW_CELLAR: /opt/homebrew/Cellar
HOMEBREW_REPOSITORY: /opt/homebrew
INFOPATH: /opt/homebrew/share/info:/opt/homebrew/share/info:
LDFLAGS: -L/opt/homebrew/opt/openssl@3/lib
CPPFLAGS: -I/opt/homebrew/opt/openssl@3/include
GREP_OPTIONS: --color=always
GREP_COLOR: 1;35;40
TERM_PROGRAM: vscode
TERM_PROGRAM_VERSION: 1.102.0
LANG: en_US.UTF-8
COLORTERM: truecolor
PYDEVD_DISABLE_FILE_VALIDATION: 1
VSCODE_DEBUGPY_ADAPTER_ENDPOINTS: /Users/swu2/.vscode/extensions/ms-python.debugpy-2025.10.0-darwin-arm64/.noConfigDebugAdapterEndpoints/endpoint-18cae102ece669ec.txt
BUNDLED_DEBUGPY_PATH: /Users/swu2/.vscode/extensions/ms-python.debugpy-2025.10.0-darwin-arm64/bundled/libs/debugpy
GIT_ASKPASS: /Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass.sh
VSCODE_GIT_ASKPASS_NODE: /Applications/Visual Studio Code.app/Contents/Frameworks/Code Helper (Plugin).app/Contents/MacOS/Code Helper (Plugin)
VSCODE_GIT_ASKPASS_EXTRA_ARGS: 
VSCODE_GIT_ASKPASS_MAIN: /Applications/Visual Studio Code.app/Contents/Resources/app/extensions/git/dist/askpass-main.js
VSCODE_GIT_IPC_HANDLE: /var/folders/dh/w8mydj5n36g_3vvhz9yhrrzh0000gq/T/vscode-git-6c3ad4fd99.sock
VSCODE_INJECTION: 1
ZDOTDIR: /Users/swu2
USER_ZDOTDIR: /Users/swu2
TERM: xterm-256color
VSCODE_PROFILE_INITIALIZED: 1
VIRTUAL_ENV: /Users/swu2/Development/communitynotes/.venv
PS1: (.venv) %n@%m %1~ %# 
_: /Users/swu2/Development/communitynotes/.venv/bin/python3
KMP_INIT_AT_FORK: FALSE
KMP_DUPLICATE_LIB_OK: True
